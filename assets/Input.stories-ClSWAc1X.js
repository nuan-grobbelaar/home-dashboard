import{j as a}from"./jsx-runtime-D_zvdyIk.js";import{r as o}from"./iframe-JmGQLgl2.js";import{i as q,G as _,W as m}from"./types-eyDxeu4t.js";import{I as b,a as E,O as T}from"./OptionSelector-BhAEcdrX.js";import"./index-DgCpqn9F.js";import"./index-BKFEeIdL.js";const f=e=>{const t=()=>Object.entries(e.insertQuery.insert).reduce((i,[c,l])=>(i[c]=l.required?{valid:!1,reason:"field not set"}:{valid:!0},i),{}),[s,r]=o.useState(t()),n=(i,c)=>{r(l=>({...l,[i]:{valid:!!c}}))},S=o.useMemo(()=>!Object.values(s).some(({valid:i})=>!i),[s]);return console.log("inputs",e.insertQuery.insert),a.jsx(b,{data:e.data,fields:e.insertQuery.insert,onSubmit:S?e.insert:()=>{},postSubmit:()=>r(t()),handleInputChange:n})};f.__docgenInfo={description:"",methods:[],displayName:"InsertForm",props:{data:{required:!0,tsType:{name:"WidgetDatasourceResponse",elements:[{name:"unknown"}],raw:"WidgetDatasourceResponse<unknown>"},description:""},insertQuery:{required:!0,tsType:{name:"InsertQuery"},description:""},insert:{required:!0,tsType:{name:"signature",type:"function",raw:"(data: { [field: string]: any }) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{ [field: string]: any }",signature:{properties:[{key:{name:"string"},value:{name:"any",required:!0}}]}},name:"data"}],return:{name:"void"}}},description:""}}};const h=e=>{console.log("input",e.data);const[t,s]=o.useState(null),r=o.useMemo(()=>Object.entries(e.data).filter(n=>q(n[1])),[]);if(r.length<1)throw new Error("No insert datasources");return o.useEffect(()=>{r.length==1&&s(r[0])},[r,s]),a.jsx("div",{className:"input_component",children:a.jsx(E,{title:`Insert ${t?t[0]:""}`,onBack:t&&r.length>1?()=>s(null):void 0,expanded:!!t,centerItemsVeritcally:!0,children:t?a.jsx(f,{data:e.data,insert:n=>e.insert(n,t[0]),insertQuery:t[1]}):a.jsx(T,{options:r,displayCallback:n=>n[0],onSelect:n=>s(n)})})})};h.__docgenInfo={description:"",methods:[],displayName:"Input",props:{data:{required:!0,tsType:{name:"WidgetDatasourceResponse",elements:[{name:"unknown"}],raw:"WidgetDatasourceResponse<unknown>"},description:""},insert:{required:!0,tsType:{name:"signature",type:"function",raw:"(data: { [field: string]: any }, datasourceName: string) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{ [field: string]: any }",signature:{properties:[{key:{name:"string"},value:{name:"any",required:!0}}]}},name:"data"},{type:{name:"string"},name:"datasourceName"}],return:{name:"void"}}},description:""},isMobile:{required:!1,tsType:{name:"boolean"},description:""}}};const{fn:O}=__STORYBOOK_MODULE_TEST__,R={title:"WidgetComponents/Input",component:h,decorators:[e=>a.jsx("div",{className:"widget-grid__widget",children:a.jsx(_,{ItemComponent:m,columns:1,rows:1,onSaveGridItem:()=>{},placerMode:"NONE",style:{height:"400px",width:"400px"},children:a.jsx(m,{position:{rowStart:1,rowEnd:2,colStart:1,colEnd:2},children:a.jsx(e,{})})})})],parameters:{layout:"centered"},tags:["autodocs"],argTypes:{data:{control:"object"}},args:{insert:O(),data:{}}},w=[{title:"Debt",value:"Debt"},{title:"Spending money ",value:"Spending money "},{title:"Health",value:"Health"},{title:"pets",value:"pets"},{title:"groceries",value:"groceries"},{title:"Household",value:"Household"},{title:"Savings",value:"Savings"},{title:"Entertainment",value:"Entertainment"},{title:"utilities",value:"utilities"},{title:"Transportation",value:"Transportation"},{title:"Beauty",value:"Beauty"},{title:"Insurance",value:"Insurance"}],D={collection:"categories",insert:{color:{type:"text",required:!1,order:"2"},name:{type:"text",order:1,required:!0}}},j={collection:"expenses",insert:{amount:{required:!0,type:"number",order:2},timestamp:{type:"datetime",order:"3",required:!0},category:{type:"select",datasource:"categories",required:!0,order:1},note:{order:4,type:"text",required:!1}}},u={args:{data:{expense:j,categories:w}}},d={args:{data:{category:D,expense:j,categories:w}}};var p,g,y;u.parameters={...u.parameters,docs:{...(p=u.parameters)==null?void 0:p.docs,source:{originalSource:`{
  args: {
    data: {
      expense: expenseInsert,
      categories: categoryList
    }
  }
}`,...(y=(g=u.parameters)==null?void 0:g.docs)==null?void 0:y.source}}};var v,x,I;d.parameters={...d.parameters,docs:{...(v=d.parameters)==null?void 0:v.docs,source:{originalSource:`{
  args: {
    data: {
      category: categoryInsert,
      expense: expenseInsert,
      categories: categoryList
    }
  }
}`,...(I=(x=d.parameters)==null?void 0:x.docs)==null?void 0:I.source}}};const F=["Primary","Multi"];export{d as Multi,u as Primary,F as __namedExportsOrder,R as default};
